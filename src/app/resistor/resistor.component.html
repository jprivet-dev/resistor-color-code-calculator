<ng-container *transloco="let t">
  <ng-container *ngIf="(decode$ | async) as decode">
    <div class="row">
      <div class="col-md-7">
        <div class="d-flex justify-content-center pt-4 pb-3 bands-count-radios">
          <div>
            <ng-container *ngFor="let count of bandsCounts">
              <input (click)="setBandsCount(count)" [checked]="decode.bandsCount === count"
                     type="radio" class="btn-check" name="bands-count"
                     id="{{ 'bands-count-radio-' + count }}"
                     autocomplete="off"
              >
              <label class="btn btn-outline-primary rounded-pill mx-1"
                     for="{{ 'bands-count-radio-' + count }}">
                {{ t('bands', {bandsCount: count}) }}
              </label>
            </ng-container>
          </div>
        </div>
        <div class="d-flex justify-content-center pt-3 pb-4">
          <app-resistor-object
            [decode]="decode"
          ></app-resistor-object>
        </div>
      </div>
      <div class="col-md-5">
        <div class="d-flex h-100 justify-content-center align-items-center my-1">
          <div class="characteristics py-2 px-4 rounded-pill">
            <h1>
              {{ resistance$ | async | format: 'resistance' }}
            </h1>
            <h2 class="text-secondary">
              {{ tolerance$ | async | format: 'tolerance' }}
              <ng-container *ngIf="decode.thermalCoefficient.active">
                - {{ thermalCoefficient$ | async | format: 'thermalCoefficient' }}
              </ng-container>
            </h2>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-center pb-3">
      <div class="table-responsive" style="width: 100%">
        <table class="table table-sm table-striped table-colors {{ 'bands-' + decode.bandsCount }}">
          <thead>
          <tr>
            <th scope="col">
              {{ t('color') | titlecase }}
            </th>
            <th scope="col" class="pb-0">
              {{ t('digit1') | titlecase }}
              <div [appResistorColor]="decode.digit1.color" class="p-1 rounded-pill"></div>
            </th>
            <th scope="col" class="pb-0">
              {{ t('digit2') | titlecase }}
              <div [appResistorColor]="decode.digit2.color" class="p-1 rounded-pill"></div>
            </th>
            <th scope="col" class="pb-0" *ngIf="decode.digit3.active">
              {{ t('digit3') | titlecase }}
              <div [appResistorColor]="decode.digit3.color" class="p-1 rounded-pill"></div>
            </th>
            <th scope="col" class="pb-0">
              {{ t('multiplier') | titlecase }}
              <div [appResistorColor]="decode.multiplier.color" class="p-1 rounded-pill"></div>
            </th>
            <th scope="col" class="pb-0">
              {{ t('tolerance') | titlecase }}
              <div [appResistorColor]="decode.tolerance.color" class="p-1 rounded-pill"></div>
            </th>
            <th scope="col" class="pb-0" *ngIf="decode.thermalCoefficient.active">
              {{ t('thermalCoefficient') | titlecase }}
              <div [appResistorColor]="decode.thermalCoefficient.color"
                   class="p-1 rounded-pill"></div>
            </th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let color of bandsColors">
            <!-- colors -->
            <th scope="row">
              <div [appResistorColor]="color" class="color-name text-start rounded-pill">
                {{ t('colorName.' + color) | titlecase }}
              </div>
            </th>
            <!-- digit1 -->
            <td>
              <div *ngIf="resistorConfig.digit1[color] !== null" class="d-grid">
                <button (click)="updateDigit1(color)"
                        [class.active]="decode.digit1.color === color"
                        class="btn btn-color text-start text-nowrap rounded-pill" type="button">
                  <span [appResistorColor]="color" class="circle-color"></span>
                  {{ resistorConfig.digit1[color] }}
                </button>
              </div>
            </td>
            <!-- digit2 -->
            <td>
              <div *ngIf="resistorConfig.digit2[color] !== null" class="d-grid">
                <button (click)="updateDigit2(color)"
                        [class.active]="decode.digit2.color === color"
                        class="btn btn-color text-start text-nowrap rounded-pill" type="button">
                  <span [appResistorColor]="color" class="circle-color"></span>
                  {{ resistorConfig.digit2[color] }}
                </button>
              </div>
            </td>
            <!-- digit3 -->
            <td *ngIf="decode.digit3.active">
              <div *ngIf="resistorConfig.digit3[color] !== null" class="d-grid">
                <button (click)="updateDigit3(color)"
                        [class.active]="decode.digit3.color === color"
                        class="btn btn-color text-start text-nowrap rounded-pill" type="button">
                  <span [appResistorColor]="color" class="circle-color"></span>
                  {{ resistorConfig.digit3[color] }}
                </button>
              </div>
            </td>
            <!-- multiplier -->
            <td>
              <div *ngIf="resistorConfig.multiplier[color] !== null" class="d-grid">
                <button (click)="updateMultiplier(color)"
                        [class.active]="decode.multiplier.color === color"
                        class="btn btn-color text-start text-nowrap rounded-pill" type="button">
                  <span [appResistorColor]="color" class="circle-color"></span>
                  {{ resistorConfig.multiplier[color] | format: 'multiplier' }}
                </button>
              </div>
            </td>
            <!-- tolerance -->
            <td>
              <div *ngIf="resistorConfig.tolerance[color] !== null" class="d-grid">
                <button (click)="updateTolerance(color)"
                        [class.active]="decode.tolerance.color === color"
                        [attr.disabled]="toleranceColorIsDisabled(decode, color)"
                        class="btn btn-color text-start text-nowrap rounded-pill" type="button">
                  <span [appResistorColor]="color" class="circle-color"></span>
                  {{ resistorConfig.tolerance[color] | format: 'tolerance' }}
                </button>
              </div>
            </td>
            <!-- thermalCoefficient -->
            <td *ngIf="decode.thermalCoefficient.active">
              <div *ngIf="resistorConfig.thermalCoefficient[color] !== null" class="d-grid">
                <button (click)="updateThermalCoefficient(color)"
                        [class.active]="decode.thermalCoefficient.color === color"
                        class="btn btn-color text-start text-nowrap rounded-pill" type="button">
                  <span [appResistorColor]="color" class="circle-color"></span>
                  {{ resistorConfig.thermalCoefficient[color] | format: 'thermalCoefficient' }}
                </button>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </ng-container>

  <div class="d-grid gap-2 d-sm-flex justify-content-sm-center mb-3">
    <button (click)="openOffcanvasE12()" [title]="t('selectResistorInSeriesE12')"
            class="btn btn-outline-primary">
      {{ t('seriesE12') }}
    </button>
    <button (click)="openOffcanvasE24()" [title]="t('selectResistorInSeriesE24')"
            class="btn btn-outline-primary">
      {{ t('seriesE24') }}
    </button>
    <button (click)="openOffcanvasArduinoStarterKit()" [title]="t('selectResistorInArduinoStarterKit')"
            class="btn btn-outline-primary">
      {{ t('arduinoStarterKit') }}
    </button>
  </div>
</ng-container>

